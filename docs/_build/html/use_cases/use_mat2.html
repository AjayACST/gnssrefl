<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; gnssrefl  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> gnssrefl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome to gnssrefl documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/understand.html">Understanding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/README_install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/func_and_utils_doc.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/modules.html">gnssrefl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/first_drivethru.html">gnssrefl use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/news.html">News <a name="news"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/news.html#bugs-features-a-name-bugs-a">Bugs/Features <a name="bugs"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/contributions_questions.html">Community and Questions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gnssrefl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/use_cases/use_mat2.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><strong>Lake Mathews, Southern California</strong></p>
<p><strong>Station name:</strong> MAT2</p>
<P align=center>
<img src=south_mat2.jpg width=500>
<P>
<p><strong>Latitude:</strong> 33.857 degrees</p>
<p><strong>Longitude:</strong> -117.437 degrees</p>
<p><strong>Ellipsoidal Height:</strong> 398 meters</p>
<p>Data archive: <a class="reference external" href="https://www.unavco.org/instrumentation/networks/status/nota/overview/MAT2">UNAVCO</a></p>
<p><a class="reference external" href="http://geodesy.unr.edu/NGLStationPages/stations/MAT2.sta">Nevada Reno site</a></p>
<P>
<a href=http://gnss-reflections.org/rzones?station=mat2&lat=0.0&lon=0.0&height=0.0&msl=off&RH=20&freq=1&nyquist=0&srate=30&eang=4&azim1=140&azim2=220&system=gps target="_blank">Reflection zones</a>
<p><strong>Pick Up Some Data</strong></p>
<p>This site has a lot of history. It is 1-Hz and multi-GNSS since ~2016.
You do not need 1-Hz for this site - but it is definitely better than the default
PBO era sampling rate of 15 seconds.  Here I have chosen to decimate the 1-Hz data to 5 seconds,
as in:</p>
<p><code>rinex2snr mat2 2022 175  -orb gnss -rate high -dec 5 -archive unavco</code></p>
<p>Note that you can use the rapid GFZ orbits after mid 2021. And before 2016, there are no multi-GNSS
observations, so you can use the default (gps-only) option.</p>
<p><strong>Evaluate the Reflection Data</strong></p>
<p><a class="reference external" href="http://gnss-reflections.org/rzones?station=mat2&amp;lat=0.0&amp;lon=0.0&amp;height=0.0&amp;msl=off&amp;RH=20&amp;freq=1&amp;nyquist=0&amp;srate=30&amp;eang=4&amp;azim1=140&amp;azim2=220&amp;system=gps">Use the Reflection Zone WebApp</a></p>
<p>What RH limits did I use? Azimuths? Elevation angles? Which direction is the water?
With that information, then look at the data.</p>
<p>Use <code>quickLook</code> with elevation angles 4-8 degrees and RH 7-35 meters:</p>
<p><code>quickLook mat2 2022 175 -e1 4 -e2 8 -h1 7 -h2 35</code></p>
<img src=try1_mat2.png>
<p><em>How did I know to use a RH region of 7 to 35 meters?</em> I did not know this initially. I first tried a limit of 20 meters,
analyzed multiple years of data and realized that during the drought of 2015 the lake retrievals disappeared (i.e.
the RH was greater than 20 meters). I re-analyzed the data using the larger limit.
Once you have <em>translated</em> the files, it really doesnâ€™t take much cpu time to re-analyze the data.</p>
<p><em>What does this image tell us?</em> I know from google maps that the lake is to the south. And there
are retrievals to the south, but they are being set to bad because the amplitude of the
reflection is so small. You can override that:</p>
<p><code>quickLook mat2 2022 175 -e1 4 -e2 8 -h1 7 -h2 35 -ampl 0</code></p>
<img src=try2_mat2.png>
<p>If the amplitude limit is set to zero, the code will rely on the peak of the Lomb Scargle
retrieval relative to the noise (peak2noise) for quality control.</p>
<p>I have manually added a red box to show the good azimuths. If I further edit the correct azimuths,
you see good strong returns in the peridograms:</p>
<p><code>quickLook mat2 2022 175 -e1 4 -e2 8 -h1 7 -h2 35 -ampl 0 -azim1 220 -azim2 275</code>:</p>
<img src=lsp-mat2.png>
<p><strong>Analyze a Fuller Dataset</strong></p>
<p>Once you have the elevation and azimuth angles set (along with details like the required amplitude,
which we are not using here), you really just need to turn the crank. Run <code>make_json_input</code> using
the information I discussed earlier (i.e. set azimuth and elevation angles limits, RH limits. Set the NReg to be
the same as the RH limits).</p>
<p>Make SNR files using <code>rinex2snr</code>. Then compute reflector heights:</p>
<p><code>gnssir mat2 2017 1 -year_end 2021 -doy_end 365</code></p>
<p>This command would analyze all the data from 2017-2021. Use <code>daily_avg</code> to create a daily average.
Play with the inputs (median filter value, number of required RH to compute a reliable average) to make sure
that you have a high quality results. My plot goes back to 2008 because I downloaded more RINEX data:</p>
<img src=mat2-avg.png>
<p>Because there were only useful GPS L1 data in the earlier dataset, I only used it for the entire time series.
In general you should use all the good frequenices that are available to you.</p>
<p><strong>In situ data:</strong></p>
<p><a class="reference external" href="https://cdec.water.ca.gov/dynamicapp/QueryWY?Stations=MHW&amp;SensorNums=15&amp;End=2022-05-20&amp;span=20+years">Monthly Data from the California Department of Water Resources</a></p>
<p><a class="reference download internal" download="" href="../_downloads/d4d8dc25a3751c2a0925e8d87d9a325a/LAKE_MATHEWS_MHW.csv"><span class="xref download myst">CSV file</span></a></p>
<img src=mathews_cdec.png>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Dr. Kristine Larson and UNAVCO.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>